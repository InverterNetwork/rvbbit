{:reco-preview "-400719963", :meta {:recos-sys {:fields {:query_map {:data-type "string", :distinct 1, :commons {"[{:select-distinct [:Lat :Long], :from [\"query/offenses_drag_749\"]} {:select [[[:min :Long] :min-long] [[:max :Long] :max-long] [[:min :Lat] :min-lat] [[:max :Lat] :max-lat] [[:avg :Lat] :a-lat] [[:avg :Long] :a-long] [[:round [:raw [\"(\" [:max :Long] \" - \" [:min :Long] \") * 55\"]] 2] :long_diff] [[:round [:raw [\"(\" [:max :Lat] \" - \" [:min :Lat] \") * 55\"]] 2] :lat_diff]], :from [\"query/offenses_drag_749\"], :where [:and [:<> :Lat -1] [:<> :Lat nil] [:<> :Long -1] [:<> :Long nil]]}]" 1}, :cardinality 100}, :shape_name {:data-type "string", :distinct 1, :commons {"point_map" 1}, :cardinality 100}, :w {:data-type "unknown", :distinct 1, :commons {nil 1}, :cardinality 100}, :combo_edn {:data-type "string", :distinct 1, :commons {"\"Lat, Long\"" 1}, :cardinality 100}, :query_map_str {:data-type "string", :distinct 1, :commons {"SELECT DISTINCT Lat, Long FROM 'query/offenses_drag_749'" 1}, :cardinality 100}, :combo_hash {:data-type "string", :distinct 1, :commons {"-400719963" 1}, :cardinality 100}, :h {:data-type "unknown", :distinct 1, :commons {nil 1}, :cardinality 100}, :condis {:data-type "string", :distinct 1, :commons {"{:country-lines? true, :us-counties? false, :us-states? false, :geo-background? true}" 1}, :cardinality 100}, :table_name {:data-type "string", :distinct 1, :commons {"offenses_drag_749" 1}, :cardinality 100}, :connection_id {:data-type "string", :distinct 1, :commons {"1611117821" 1}, :cardinality 100}, :context_hash {:data-type "string", :distinct 1, :commons {"525542104" 1}, :cardinality 100}, :viz_map {:data-type "string", :distinct 1, :commons {"[:box :child [:vega-lite {:width \"container\", :height :panel-height+50, :autosize \"none\", :padding {:top 0, :bottom 0, :left 0, :right 0}, :params [{:name \"tx\", :expr \"width/2\"} {:name \"ty\", :expr \"height/2\"} {:name \"zoom_precise\", :value :query-preview-2/long_diff.0, :bind {:input \"range\", :min 2, :max 30, :step 0.05}} {:name \"centerY\", :value :query-preview-2/a_lat.0, :bind {:input \"range\", :min :query-preview-2/min_lat.0, :max :query-preview-2/max_lat.0, :full-min -60, :full-max 60, :step 1.0E-6}} {:name \"centerX\", :value :query-preview-2/a_long.0, :bind {:input \"range\", :min :query-preview-2/min_long.0, :max :query-preview-2/max_long.0, :full-min -180, :full-max 180, :step 1.0E-6}} {:name \"baseTileSize\", :value 256} {:name \"tileUrl\", :value \"https://a.tile.openstreetmap.org/\"} {:name \"zoom\", :expr \"ceil(zoom_precise)\"} {:name \"tilesCount\", :expr \"pow(2,zoom)\"} {:name \"tileSize\", :expr \"baseTileSize*pow(2,zoom_precise-zoom)\"} {:name \"maxTiles\", :expr \"ceil(max(height,width)/tileSize +1)\"} {:name \"basePoint\", :expr \"invert('projection',[0,0])\"} {:name \"dii\", :expr \"((basePoint[0]+180)/360*tilesCount)\"} {:name \"di\", :expr \"floor(dii)\"} {:name \"dx\", :expr \"round((floor(dii)-dii)*tileSize)\"} {:name \"djj\", :expr \"((1-log(tan(basePoint[1]*PI/180) + 1/cos(basePoint[1]*PI/180))/PI)/2 *tilesCount)\"} {:name \"dj\", :expr \"floor(djj)\"} {:name \"dy\", :expr \"round((floor(djj)-djj)*tileSize)\"} {:name \"scale\", :expr \"baseTileSize * pow(2,zoom_precise) / (2 * PI)\"}], :layer [[:if :condi/geo-background? {:data {:name \"tile_list\", :sequence {:start 0, :stop {:signal \"maxTiles\"}, :as \"a\"}}, :transform [{:calculate \"sequence(0,maxTiles)\", :as \"b\"} {:flatten [\"b\"]} {:calculate \"tileUrl+zoom+'/'+(datum.a+di+tilesCount)%tilesCount+'/'+((datum.b+dj))+'.png'\", :as \"url\"} {:calculate \"(datum.a * tileSize + dx)+(tileSize/2)\", :as \"x\"} {:calculate \"(datum.b * tileSize + dy)+(tileSize/2)\", :as \"y\"}], :mark {:type \"image\", :opacity 0.5, :background \"#000000\", :fill \"#000000\", :width {:signal \"tileSize\"}, :height {:signal \"tileSize\"}}, :encoding {:x {:field \"x\", :type \"quantitative\", :scale nil}, :y {:field \"y\", :type \"quantitative\", :scale nil}, :url {:field \"url\", :type \"nominal\"}}} {:mark \"geoshape\", :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}}] {:data {:values :query-preview}, :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}, :mark {:type \"point\"}, :encoding {:latitude {:field :Lat, :type \"quantitative\"}, :size {:field nil, :type \"quantitative\"}, :color {:field 1, :scale {:scheme \"darkmulti\"}, :type \"nominal\"}, :longitude {:field :Long, :type \"quantitative\"}}, :background \"transparent\"} [:if :condi/us-counties? {:data {:name \"us-counties\", :url \"https://raw.githubusercontent.com/vega/vega/61dd8b1fdb9a268dc80c986938a5983d27cf8f2c/docs/data/us-10m.json\", :format {:type \"topojson\", :feature \"counties\"}}, :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}, :mark \"geoshape\", :encoding {:fill {:value \"#a500ff22\"}, :fillOpacity {:value 0.1}, :stroke {:value \"#FFA50022\"}, :strokeWidth {:value 2}}, :background \"transparent\"} {:mark \"geoshape\", :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}}] [:if :condi/us-states? {:data {:name \"us-states\", :url \"https://raw.githubusercontent.com/vega/vega/61dd8b1fdb9a268dc80c986938a5983d27cf8f2c/docs/data/us-10m.json\", :format {:type \"topojson\", :feature \"states\"}}, :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}, :mark \"geoshape\", :encoding {:fill {:value \"#FFA50044\"}, :fillOpacity {:value 0.1}, :stroke {:value \"#FFA50044\"}, :strokeWidth {:value 2}}, :background \"transparent\"} {:mark \"geoshape\", :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}}] [:if :condi/country-lines? {:data {:name \"world\", :url \"https://vega.github.io/vega-datasets/data/world-110m.json\", :format {:type \"topojson\", :feature \"countries\"}}, :mark \"geoshape\", :encoding {:fill {:value \"#FFA500\"}, :fillOpacity {:value 0.1}, :stroke {:value \"#FFA500\"}, :strokeWidth {:value 2}}, :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}} {:mark \"geoshape\", :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}}]], :background \"transparent\", :config {:view {:stroke \"transparent\"}}} {:actions false}]]" 1}, :cardinality 100}}, :rowcount 1}, :blocks-sys {:fields {}, :rowcount 0}, :fields-sys {:fields {:field_name {:data-type "string", :distinct 10, :commons {"fips_county_code" 1, "state_abbrev" 1, "population" 1}, :cardinality 100}, :field_type {:data-type "string", :distinct 2, :commons {"INTEGER" 8, "VARCHAR" 2}, :cardinality 20}, :data_type {:data-type "string", :distinct 2, :commons {"integer" 8, "string" 2}, :cardinality 20}}, :rowcount 10}, :gen-viz-960 {:fields {:min_long {:data-type "float", :distinct 1, :commons {-71.17867378 1}, :cardinality 100}, :max_long {:data-type "float", :distinct 1, :commons {-70.96367615 1}, :cardinality 100}, :min_lat {:data-type "float", :distinct 1, :commons {42.2324133 1}, :cardinality 100}, :max_lat {:data-type "float", :distinct 1, :commons {42.39504158 1}, :cardinality 100}, :a_lat {:data-type "float", :distinct 1, :commons {42.322297869367375 1}, :cardinality 100}, :a_long {:data-type "float", :distinct 1, :commons {-71.08285029600603 1}, :cardinality 100}, :long_diff {:data-type "float", :distinct 1, :commons {11.82 1}, :cardinality 100}, :lat_diff {:data-type "float", :distinct 1, :commons {8.94 1}, :cardinality 100}}, :rowcount 1}, :viz-shapes-sys {:fields {:combo_edn {:data-type "string", :distinct 1, :commons {"\"Lat, Long\"" 1}, :cardinality 100}, :recos {:data-type "integer", :distinct 1, :commons {1 1}, :cardinality 100}}, :rowcount 1}, :tables-sys {:fields {:db_schema {:data-type "string", :distinct 1, :commons {"none" 7}, :cardinality 14}, :db_catalog {:data-type "unknown", :distinct 1, :commons {nil 7}, :cardinality 14}, :connection_id {:data-type "string", :distinct 1, :commons {"-1028099156" 7}, :cardinality 14}, :schema_cat {:data-type "unknown", :distinct 1, :commons {nil 7}, :cardinality 14}, :table_name {:data-type "string", :distinct 7, :commons {"ref_us_zipcodes" 1, "ref_us_states" 1, "ref_us_counties" 1}, :cardinality 100}, :fields {:data-type "integer", :distinct 5, :commons {4 2, 11 2, 7 1}, :cardinality 71}}, :rowcount 7}, :ref_us_counties {:fields {:water_area {:data-type "integer", :distinct 498, :commons {4675 2, 2654 2, 124994 1}, :cardinality 99}, :housing_units {:data-type "integer", :distinct 498, :commons {3222 2, 4792 2, 157055 1}, :cardinality 99}, :fips_county_code {:data-type "integer", :distinct 141, :commons {1 10, 5 9, 3 9}, :cardinality 28}, :name {:data-type "string", :distinct 411, :commons {"Jefferson County" 5, "Jackson County" 5, "Marion County" 4}, :cardinality 82}, :land_area {:data-type "integer", :distinct 500, :commons {2864221 1, 1505028 1, 1929532 1}, :cardinality 100}, :longitude {:data-type "integer", :distinct 500, :commons {-8180615 1, -9242342 1, -8729553 1}, :cardinality 100}, :fips_state_code {:data-type "integer", :distinct 11, :commons {13 118, 5 75, 12 67}, :cardinality 2}, :state_abbrev {:data-type "string", :distinct 11, :commons {"GA" 118, "AR" 75, "AL" 67}, :cardinality 2}, :population {:data-type "integer", :distinct 498, :commons {11793 2, 7841 2, 25691 1}, :cardinality 99}, :latitude {:data-type "integer", :distinct 500, :commons {34648426 1, 26641412 1, 39662375 1}, :cardinality 100}}, :rowcount 500}, :files-sys {:fields {:file_path {:data-type "string", :distinct 13, :commons {"./screens/boston-crime-test-screen.edn" 1, "./screens/boston-crime-test-screen-filter.edn" 1, "./screens/boston-pd-districts-map-test.edn" 1}, :cardinality 100}, :screen_name {:data-type "string", :distinct 12, :commons {"unnamed-screen!" 2, "highlight-test-wednesday" 1, "vselect-test-saturaday!" 1}, :cardinality 92}, :blocks {:data-type "integer", :distinct 8, :commons {11 2, 3 2, 8 2}, :cardinality 61}, :queries {:data-type "integer", :distinct 8, :commons {6 3, 10 2, 4 2}, :cardinality 61}, :ts {:data-type "string", :distinct 2, :commons {"2023-01-21 19:07:21" 11, "2023-01-21 19:07:20" 2}, :cardinality 15}}, :rowcount 13}, :viz-tables-sys {:fields {:table_name {:data-type "string", :distinct 3, :commons {"offenses_drag_749" 1, "gen_viz_960" 1, "gen_viz_1104" 1}, :cardinality 100}, :recos {:data-type "integer", :distinct 3, :commons {407 1, 14 1, 2 1}, :cardinality 100}}, :rowcount 3}, :offense-codes-drag-854 {:fields {:CODE {:data-type "integer", :distinct 389, :commons {2605 2, 2204 2, 2660 2}, :cardinality 77}, :NAME {:data-type "string", :distinct 435, :commons {"MANSLAUGHTER - NON-VEHICLE - NEGLIGENCE" 2, "M/V - LEAVING SCENE - PROPERTY DAMAGE" 2, "BIOLOGICAL THREATS" 2}, :cardinality 87}}, :rowcount 500}, :viz-shapes0-sys {:fields {:shape {:data-type "string", :distinct 16, :commons {"point_map_freq" 1, "basic_h_bar_avg_color" 1, "point_map" 1}, :cardinality 100}, :recos {:data-type "integer", :distinct 10, :commons {18 2, 12 2, 6 2}, :cardinality 62}}, :rowcount 16}, :ref-us-counties-drag-155 {:fields {:water_area {:data-type "integer", :distinct 498, :commons {4675 2, 2654 2, 124994 1}, :cardinality 99}, :housing_units {:data-type "integer", :distinct 498, :commons {3222 2, 4792 2, 157055 1}, :cardinality 99}, :fips_county_code {:data-type "integer", :distinct 141, :commons {1 10, 5 9, 3 9}, :cardinality 28}, :name {:data-type "string", :distinct 411, :commons {"Jefferson County" 5, "Jackson County" 5, "Marion County" 4}, :cardinality 82}, :land_area {:data-type "integer", :distinct 500, :commons {2864221 1, 1505028 1, 1929532 1}, :cardinality 100}, :longitude {:data-type "integer", :distinct 500, :commons {-8180615 1, -9242342 1, -8729553 1}, :cardinality 100}, :fips_state_code {:data-type "integer", :distinct 11, :commons {13 118, 5 75, 12 67}, :cardinality 2}, :state_abbrev {:data-type "string", :distinct 11, :commons {"GA" 118, "AR" 75, "AL" 67}, :cardinality 2}, :population {:data-type "integer", :distinct 498, :commons {11793 2, 7841 2, 25691 1}, :cardinality 99}, :latitude {:data-type "integer", :distinct 500, :commons {34648426 1, 26641412 1, 39662375 1}, :cardinality 100}}, :rowcount 500}, :gen-viz-1104 {:fields {:Lat {:data-type "float", :distinct 500, :commons {42.30803768 1, 42.34717072 1, 42.3524123 1}, :cardinality 100}, :Long {:data-type "float", :distinct 500, :commons {-71.08566213 1, -71.12079258 1, -71.14426332 1}, :cardinality 100}}, :rowcount 500}, :query-preview {:fields {:Lat {:data-type "float", :distinct 500, :commons {42.30803768 1, 42.34717072 1, 42.3524123 1}, :cardinality 100}, :Long {:data-type "float", :distinct 500, :commons {-71.08566213 1, -71.12079258 1, -71.14426332 1}, :cardinality 100}}, :rowcount 500}, :offense_codes {:fields {:CODE {:data-type "integer", :distinct 389, :commons {2605 2, 2204 2, 2660 2}, :cardinality 77}, :NAME {:data-type "string", :distinct 435, :commons {"MANSLAUGHTER - NON-VEHICLE - NEGLIGENCE" 2, "M/V - LEAVING SCENE - PROPERTY DAMAGE" 2, "BIOLOGICAL THREATS" 2}, :cardinality 87}}, :rowcount 500}, :offenses-drag-749 {:fields {:SHOOTING {:data-type "unknown", :distinct 1, :commons {nil 500}, :cardinality 0}, :DISTRICT {:data-type "string", :distinct 13, :commons {"C11" 82, "B2" 75, "B3" 49}, :cardinality 2}, :INCIDENT_NUMBER {:data-type "string", :distinct 454, :commons {"I182070397" 5, "I182070779" 4, "I182070889" 3}, :cardinality 90}, :OFFENSE_DESCRIPTION {:data-type "string", :distinct 89, :commons {"SICK/INJURED/MEDICAL - PERSON" 43, "VERBAL DISPUTE" 34, "INVESTIGATE PERSON" 33}, :cardinality 17}, :DAY_OF_WEEK {:data-type "string", :distinct 7, :commons {"0001-01-07" 228, "0001-01-08" 178, "0001-01-06" 75}, :cardinality 1}, :MONTH {:data-type "integer", :distinct 4, :commons {9 477, 8 21, 7 1}, :cardinality 0}, :YEAR {:data-type "integer", :distinct 1, :commons {2018 500}, :cardinality 0}, :HOUR {:data-type "integer", :distinct 24, :commons {18 45, 14 33, 20 32}, :cardinality 4}, :STREET {:data-type "string", :distinct 275, :commons {nil 41, "WASHINGTON ST" 20, "HUNTINGTON AVE" 12}, :cardinality 55}, :OFFENSE_CODE_GROUP {:data-type "string", :distinct 41, :commons {"Motor Vehicle Accident Response" 69, "Medical Assistance" 50, "Larceny" 41}, :cardinality 8}, :UCR_PART {:data-type "string", :distinct 4, :commons {"Part Three" 265, "Part Two" 140, "Part One" 93}, :cardinality 0}, :Long {:data-type "float", :distinct 413, :commons {-1 6, -71.1136693 5, nil 5}, :cardinality 82}, :REPORTING_AREA {:data-type "integer", :distinct 282, :commons {nil 42, 519 6, 177 5}, :cardinality 56}, :Location {:data-type "string", :distinct 413, :commons {"(-1.00000000, -1.00000000)" 6, "(0.00000000, 0.00000000)" 5, "(42.24635332, -71.11366930)" 5}, :cardinality 82}, :OFFENSE_CODE {:data-type "integer", :distinct 89, :commons {3006 43, 3301 34, 3115 33}, :cardinality 17}, :Lat {:data-type "float", :distinct 413, :commons {-1 6, 42.24635332 5, nil 5}, :cardinality 82}, :OCCURRED_ON_DATE {:data-type "string", :distinct 404, :commons {"2018-09-02 00:00:00.000000" 5, "2018-09-03 10:00:00.000000" 5, "2018-09-01 17:03:00.000000" 5}, :cardinality 80}}, :rowcount 500}, :offenses {:fields {:SHOOTING {:data-type "unknown", :distinct 1, :commons {nil 500}, :cardinality 0}, :DISTRICT {:data-type "string", :distinct 13, :commons {"C11" 82, "B2" 75, "B3" 49}, :cardinality 2}, :INCIDENT_NUMBER {:data-type "string", :distinct 454, :commons {"I182070397" 5, "I182070779" 4, "I182070889" 3}, :cardinality 90}, :OFFENSE_DESCRIPTION {:data-type "string", :distinct 89, :commons {"SICK/INJURED/MEDICAL - PERSON" 43, "VERBAL DISPUTE" 34, "INVESTIGATE PERSON" 33}, :cardinality 17}, :DAY_OF_WEEK {:data-type "string", :distinct 7, :commons {"0001-01-07" 228, "0001-01-08" 178, "0001-01-06" 75}, :cardinality 1}, :MONTH {:data-type "integer", :distinct 4, :commons {9 477, 8 21, 7 1}, :cardinality 0}, :YEAR {:data-type "integer", :distinct 1, :commons {2018 500}, :cardinality 0}, :HOUR {:data-type "integer", :distinct 24, :commons {18 45, 14 33, 20 32}, :cardinality 4}, :STREET {:data-type "string", :distinct 275, :commons {nil 41, "WASHINGTON ST" 20, "HUNTINGTON AVE" 12}, :cardinality 55}, :OFFENSE_CODE_GROUP {:data-type "string", :distinct 41, :commons {"Motor Vehicle Accident Response" 69, "Medical Assistance" 50, "Larceny" 41}, :cardinality 8}, :UCR_PART {:data-type "string", :distinct 4, :commons {"Part Three" 265, "Part Two" 140, "Part One" 93}, :cardinality 0}, :Long {:data-type "float", :distinct 413, :commons {-1 6, -71.1136693 5, nil 5}, :cardinality 82}, :REPORTING_AREA {:data-type "integer", :distinct 282, :commons {nil 42, 519 6, 177 5}, :cardinality 56}, :Location {:data-type "string", :distinct 413, :commons {"(-1.00000000, -1.00000000)" 6, "(0.00000000, 0.00000000)" 5, "(42.24635332, -71.11366930)" 5}, :cardinality 82}, :OFFENSE_CODE {:data-type "integer", :distinct 89, :commons {3006 43, 3301 34, 3115 33}, :cardinality 17}, :Lat {:data-type "float", :distinct 413, :commons {-1 6, 42.24635332 5, nil 5}, :cardinality 82}, :OCCURRED_ON_DATE {:data-type "string", :distinct 404, :commons {"2018-09-02 00:00:00.000000" 5, "2018-09-03 10:00:00.000000" 5, "2018-09-01 17:03:00.000000" 5}, :cardinality 80}}, :rowcount 500}, :status-sys {:fields {}, :rowcount 0}, :query-10391 {:fields {:rowcnt {:data-type "integer", :distinct 47, :commons {67 3, 14 2, 5 2}, :cardinality 92}, :fips_state_code {:data-type "integer", :distinct 51, :commons {49 1, 8 1, 37 1}, :cardinality 100}}, :rowcount 51}, :connections-sys {:fields {:database_name {:data-type "string", :distinct 5, :commons {"SQLite" 2, "ClickHouse" 1, "Vertica Database" 1}, :cardinality 83}, :connection_id {:data-type "string", :distinct 6, :commons {"-552114572" 1, "-349446958" 1, "-221232055" 1}, :cardinality 100}}, :rowcount 6}, :query-preview-2 {:fields {:min_long {:data-type "float", :distinct 1, :commons {-71.17867378 1}, :cardinality 100}, :max_long {:data-type "float", :distinct 1, :commons {-70.96367615 1}, :cardinality 100}, :min_lat {:data-type "float", :distinct 1, :commons {42.2324133 1}, :cardinality 100}, :max_lat {:data-type "float", :distinct 1, :commons {42.39504158 1}, :cardinality 100}, :a_lat {:data-type "float", :distinct 1, :commons {42.322297869367375 1}, :cardinality 100}, :a_long {:data-type "float", :distinct 1, :commons {-71.08285029600603 1}, :cardinality 100}, :long_diff {:data-type "float", :distinct 1, :commons {11.82 1}, :cardinality 100}, :lat_diff {:data-type "float", :distinct 1, :commons {8.94 1}, :cardinality 100}}, :rowcount 1}}, :editor? true, :re-pressed.core/keydown {:keys [{:altKey false, :ctrlKey false, :metaKey false, :shiftKey false, :keyCode 32} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey false, :keyCode 27} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey true, :keyCode 87} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey true, :keyCode 87} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey true, :keyCode 68} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey true, :keyCode 68} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey true, :keyCode 68} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey true, :keyCode 68} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey true, :keyCode 68} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey true, :keyCode 68} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey false, :keyCode 65} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey false, :keyCode 65} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey false, :keyCode 65} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey false, :keyCode 65} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey false, :keyCode 65} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey false, :keyCode 65} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey false, :keyCode 65} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey false, :keyCode 65} {:altKey false, :ctrlKey false, :metaKey false, :shiftKey false, :keyCode 65}], :event-keys [[[:viz-yard.bricks/select-block "none!"] [{:keyCode 27}]] [[:viz-yard.bricks/redo-one] [{:keyCode 90, :ctrlKey true, :shiftKey true}]] [[:viz-yard.bricks/undo-one] [{:keyCode 90, :ctrlKey true, :shiftKey false}]] [[:viz-yard.bricks/toggle-editor] [{:keyCode 32}]] [[:viz-yard.bricks/next-panel] [{:keyCode 9}]] [[:viz-yard.bricks/stretch-panel :wider] [{:keyCode 68, :shiftKey true}]] [[:viz-yard.bricks/stretch-panel :longer] [{:keyCode 83, :shiftKey true}]] [[:viz-yard.bricks/stretch-panel :narrower] [{:keyCode 65, :shiftKey true}]] [[:viz-yard.bricks/stretch-panel :shorter] [{:keyCode 87, :shiftKey true}]] [[:viz-yard.bricks/panel-depth-up] [{:keyCode 82, :shiftKey true}]] [[:viz-yard.bricks/panel-depth-down] [{:keyCode 70, :shiftKey true}]] [[:viz-yard.bricks/nudge-panel :up] [{:keyCode 87}]] [[:viz-yard.bricks/nudge-panel :down] [{:keyCode 83}]] [[:viz-yard.bricks/nudge-panel :left] [{:keyCode 65}]] [[:viz-yard.bricks/nudge-panel :right] [{:keyCode 68}]]], :clear-keys nil, :always-listen-keys nil, :prevent-default-keys [{:keyCode 32} {:keyCode 83, :ctrlKey true} {:keyCode 9} {:keyCode 70, :ctrlKey true}]}, :client-name :spirited-lavender-swallow-of-the-dune-system, :window {:w 3061, :h 1286}, :post-meta {:offenses-drag-749 {:SHOOTING {:distinct 1}, :DISTRICT {:distinct 12}, :* {:rowcount 319073}, :INCIDENT_NUMBER {:distinct 282517}, :OFFENSE_DESCRIPTION {:distinct 244}, :DAY_OF_WEEK {:distinct 7}, :MONTH {:distinct 12}, :YEAR {:distinct 4}, :HOUR {:distinct 24}, :STREET {:distinct 4657}, :OFFENSE_CODE_GROUP {:distinct 67}, :UCR_PART {:distinct 4}, :Long {:distinct 18178}, :REPORTING_AREA {:distinct 878}, :Location {:distinct 18194}, :OFFENSE_CODE {:distinct 222}, :Lat {:distinct 18178}, :OCCURRED_ON_DATE {:distinct 233229}}, :offense-codes-drag-854 {:* {:rowcount 576}, :CODE {:distinct 425}, :NAME {:distinct 479}}, :query-preview-2 {:* {:rowcount 1}, :a_lat {:distinct 1}, :min_lat {:distinct 1}, :long_diff {:distinct 1}, :max_lat {:distinct 1}, :lat_diff {:distinct 1}, :max_long {:distinct 1}, :a_long {:distinct 1}, :min_long {:distinct 1}}, :gen-viz-1104 {:* {:rowcount 18194}, :Lat {:distinct 18178}, :Long {:distinct 18178}}, :gen-viz-960 {:* {:rowcount 1}, :a_lat {:distinct 1}, :min_lat {:distinct 1}, :long_diff {:distinct 1}, :max_lat {:distinct 1}, :lat_diff {:distinct 1}, :max_long {:distinct 1}, :a_long {:distinct 1}, :min_long {:distinct 1}}, :ref-us-counties-drag-155 {:water_area {:distinct 3024}, :housing_units {:distinct 2962}, :* {:rowcount 3141}, :fips_county_code {:distinct 321}, :name {:distinct 1874}, :land_area {:distinct 3139}, :longitude {:distinct 3141}, :fips_state_code {:distinct 51}, :state_abbrev {:distinct 51}, :population {:distinct 3078}, :latitude {:distinct 3140}}, :query-10391 {:* {:rowcount 51}, :rowcnt {:distinct 47}, :fips_state_code {:distinct 51}}}, :query-history-meta {:offenses-drag-749 {:SHOOTING {:distinct 1388818156}, :DISTRICT {:distinct 526644159}, :* {:rowcount -854216811}, :INCIDENT_NUMBER {:distinct 1311867546}, :OFFENSE_DESCRIPTION {:distinct 1074390965}, :DAY_OF_WEEK {:distinct 256475374}, :MONTH {:distinct 1149159290}, :YEAR {:distinct -1171941475}, :HOUR {:distinct -360488076}, :STREET {:distinct 1482479043}, :OFFENSE_CODE_GROUP {:distinct 23091203}, :UCR_PART {:distinct 1931755841}, :Long {:distinct 1184210912}, :REPORTING_AREA {:distinct 1512316234}, :Location {:distinct 256284968}, :OFFENSE_CODE {:distinct -1749223725}, :Lat {:distinct -407926735}, :OCCURRED_ON_DATE {:distinct 740530860}}, :offense-codes-drag-854 {:* {:rowcount 821602504}, :CODE {:distinct -508536159}, :NAME {:distinct -70734169}}, :query-preview-2 {:* {:rowcount 1740623921}, :a_lat {:distinct -1054004636}, :min_lat {:distinct 165917059}, :long_diff {:distinct -1374309618}, :max_lat {:distinct -1785808559}, :lat_diff {:distinct 1555000772}, :max_long {:distinct -1704434339}, :a_long {:distinct 976512299}, :min_long {:distinct -91340979}}, :gen-viz-1104 {:* {:rowcount 1074090417}, :Lat {:distinct 1041854467}, :Long {:distinct -143223914}}, :gen-viz-960 {:* {:rowcount 1740623921}, :a_lat {:distinct -1054004636}, :min_lat {:distinct 165917059}, :long_diff {:distinct -1374309618}, :max_lat {:distinct -1785808559}, :lat_diff {:distinct 1555000772}, :max_long {:distinct -1704434339}, :a_long {:distinct 976512299}, :min_long {:distinct -91340979}}, :ref-us-counties-drag-155 {:water_area {:distinct 154386737}, :housing_units {:distinct -790092028}, :* {:rowcount -2006490793}, :fips_county_code {:distinct -1530368377}, :name {:distinct 1921512383}, :land_area {:distinct -1746251928}, :longitude {:distinct -2053569060}, :fips_state_code {:distinct 647062228}, :state_abbrev {:distinct -1959574678}, :population {:distinct -125251513}, :latitude {:distinct -1572297360}}, :query-10391 {:* {:rowcount 203022385}, :rowcnt {:distinct -467279133}, :fips_state_code {:distinct 1885159485}}}, :screen-name "us-state-map-fips-test", :re-pollsive.core/polling {:rules [{:interval 5, :event [:viz-yard.bricks/update-metadata], :dispatch-event-on-start? false, :started-at 0, :stopped-time-since-last-poll nil, :started-before? true} {:interval 1, :event [:viz-yard.bricks/update-metadata-tabs], :dispatch-event-on-start? false, :started-at 0, :stopped-time-since-last-poll nil, :started-before? true} {:interval 1, :event [:viz-yard.bricks/update-conditionals], :dispatch-event-on-start? false, :started-at 0, :stopped-time-since-last-poll nil, :started-before? true} {:interval 4, :event [:viz-yard.bricks/refresh-status], :poll-when [:viz-yard.bricks/bg-status?], :dispatch-event-on-start? false, :started-at nil, :stopped-time-since-last-poll 1, :started-before? true}], :counter 1966}, :websocket-fx.core/sockets {:default {:status :connected, :options {:url "ws://localhost:3000/ws", :format :edn, :on-disconnect [:websocket-fx.core/unsubscribe :default :server-push2], :on-connect [:websocket-fx.core/subscribe :default :server-push2 {:message {:kind :server-push2, :client-name :spirited-lavender-swallow-of-the-dune-system, :ui-keypath [:server], :extras {:hello? true}}, :on-message [:viz-yard.http/simple-response]}]}, :subscriptions {:server-push2 {:message {:kind :server-push2, :client-name :spirited-lavender-swallow-of-the-dune-system, :ui-keypath [:server], :extras {:hello? true}}, :on-message [:viz-yard.http/simple-response]}}}}, :panels {:block-11241 {:h 7, :w 30, :connection-id "1265875721", :name "select-all-offenses", :queries {:offenses-drag-749 {:select [:DAY_OF_WEEK :DISTRICT :HOUR :INCIDENT_NUMBER :Lat :Location :Long :MONTH :OCCURRED_ON_DATE :OFFENSE_CODE :OFFENSE_CODE_GROUP :OFFENSE_DESCRIPTION :REPORTING_AREA :SHOOTING :STREET :UCR_PART :YEAR], :from [[:offenses :cc146]]}}, :root [1 0]}, :reco-preview {:h 9, :w 9, :root [200 200], :name "point_map - \"Lat, Long\" - 1076", :connection-id "1265875721", :views {:oz [:box :child [:vega-lite {:width "container", :height :panel-height+50, :autosize "none", :padding {:top 0, :bottom 0, :left 0, :right 0}, :params [{:name "tx", :expr "width/2"} {:name "ty", :expr "height/2"} {:name "zoom_precise", :value :query-preview-2/long_diff.0, :bind {:input "range", :min 2, :max 30, :step 0.05}} {:name "centerY", :value :query-preview-2/a_lat.0, :bind {:input "range", :min :query-preview-2/min_lat.0, :max :query-preview-2/max_lat.0, :full-min -60, :full-max 60, :step 1.0E-6}} {:name "centerX", :value :query-preview-2/a_long.0, :bind {:input "range", :min :query-preview-2/min_long.0, :max :query-preview-2/max_long.0, :full-min -180, :full-max 180, :step 1.0E-6}} {:name "baseTileSize", :value 256} {:name "tileUrl", :value "https://a.tile.openstreetmap.org/"} {:name "zoom", :expr "ceil(zoom_precise)"} {:name "tilesCount", :expr "pow(2,zoom)"} {:name "tileSize", :expr "baseTileSize*pow(2,zoom_precise-zoom)"} {:name "maxTiles", :expr "ceil(max(height,width)/tileSize +1)"} {:name "basePoint", :expr "invert('projection',[0,0])"} {:name "dii", :expr "((basePoint[0]+180)/360*tilesCount)"} {:name "di", :expr "floor(dii)"} {:name "dx", :expr "round((floor(dii)-dii)*tileSize)"} {:name "djj", :expr "((1-log(tan(basePoint[1]*PI/180) + 1/cos(basePoint[1]*PI/180))/PI)/2 *tilesCount)"} {:name "dj", :expr "floor(djj)"} {:name "dy", :expr "round((floor(djj)-djj)*tileSize)"} {:name "scale", :expr "baseTileSize * pow(2,zoom_precise) / (2 * PI)"}], :layer [[:if :condi/geo-background? {:data {:name "tile_list", :sequence {:start 0, :stop {:signal "maxTiles"}, :as "a"}}, :transform [{:calculate "sequence(0,maxTiles)", :as "b"} {:flatten ["b"]} {:calculate "tileUrl+zoom+'/'+(datum.a+di+tilesCount)%tilesCount+'/'+((datum.b+dj))+'.png'", :as "url"} {:calculate "(datum.a * tileSize + dx)+(tileSize/2)", :as "x"} {:calculate "(datum.b * tileSize + dy)+(tileSize/2)", :as "y"}], :mark {:type "image", :opacity 0.5, :background "#000000", :fill "#000000", :width {:signal "tileSize"}, :height {:signal "tileSize"}}, :encoding {:x {:field "x", :type "quantitative", :scale nil}, :y {:field "y", :type "quantitative", :scale nil}, :url {:field "url", :type "nominal"}}} {:mark "geoshape", :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}}] {:data {:values :query-preview}, :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}, :mark {:type "point"}, :encoding {:latitude {:field :Lat, :type "quantitative"}, :size {:field nil, :type "quantitative"}, :color {:field 1, :scale {:scheme "darkmulti"}, :type "nominal"}, :longitude {:field :Long, :type "quantitative"}}, :background "transparent"} [:if :condi/us-counties? {:data {:name "us-counties", :url "https://raw.githubusercontent.com/vega/vega/61dd8b1fdb9a268dc80c986938a5983d27cf8f2c/docs/data/us-10m.json", :format {:type "topojson", :feature "counties"}}, :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}, :mark "geoshape", :encoding {:fill {:value "#a500ff22"}, :fillOpacity {:value 0.1}, :stroke {:value "#FFA50022"}, :strokeWidth {:value 2}}, :background "transparent"} {:mark "geoshape", :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}}] [:if :condi/us-states? {:data {:name "us-states", :url "https://raw.githubusercontent.com/vega/vega/61dd8b1fdb9a268dc80c986938a5983d27cf8f2c/docs/data/us-10m.json", :format {:type "topojson", :feature "states"}}, :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}, :mark "geoshape", :encoding {:fill {:value "#FFA50044"}, :fillOpacity {:value 0.1}, :stroke {:value "#FFA50044"}, :strokeWidth {:value 2}}, :background "transparent"} {:mark "geoshape", :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}}] [:if :condi/country-lines? {:data {:name "world", :url "https://vega.github.io/vega-datasets/data/world-110m.json", :format {:type "topojson", :feature "countries"}}, :mark "geoshape", :encoding {:fill {:value "#FFA500"}, :fillOpacity {:value 0.1}, :stroke {:value "#FFA500"}, :strokeWidth {:value 2}}, :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}} {:mark "geoshape", :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}}]], :background "transparent", :config {:view {:stroke "transparent"}}} {:actions false}]]}, :queries {:query-preview {:select-distinct [:Lat :Long], :from [:query/offenses-drag-749]}, :query-preview-2 {:select [[[:min :Long] :min-long] [[:max :Long] :max-long] [[:min :Lat] :min-lat] [[:max :Lat] :max-lat] [[:avg :Lat] :a-lat] [[:avg :Long] :a-long] [[:round [:raw ["(" [:max :Long] " - " [:min :Long] ") * 55"]] 2] :long_diff] [[:round [:raw ["(" [:max :Lat] " - " [:min :Lat] ") * 55"]] 2] :lat_diff]], :from [:query/offenses-drag-749], :where [:and [:<> :Lat -1] [:<> :Lat nil] [:<> :Long -1] [:<> :Long nil]]}}, :conditionals {:country-lines? true, :us-counties? false, :us-states? false, :geo-background? true}}, :block-382 {:name "point_map - \"Lat, Long\" - 1076", :w 9, :root [31 0], :h 7, :connection-id "1265875721", :queries {:gen-viz-1104 {:select-distinct [:Lat :Long], :from [:query/offenses-drag-749]}, :gen-viz-960 {:select [[[:min :Long] :min-long] [[:max :Long] :max-long] [[:min :Lat] :min-lat] [[:max :Lat] :max-lat] [[:avg :Lat] :a-lat] [[:avg :Long] :a-long] [[:round [:raw ["(" [:max :Long] " - " [:min :Long] ") * 55"]] 2] :long_diff] [[:round [:raw ["(" [:max :Lat] " - " [:min :Lat] ") * 55"]] 2] :lat_diff]], :from [:query/offenses-drag-749], :where [:and [:<> :Lat -1] [:<> :Lat nil] [:<> :Long -1] [:<> :Long nil]]}}, :conditionals {:country-lines? true, :us-counties? true, :us-states? true, :geo-background? true}, :views {:oz [:box :child [:vega-lite {:width "container", :height :panel-height+50, :autosize "none", :padding {:top 0, :bottom 0, :left 0, :right 0}, :params [{:name "tx", :expr "width/2"} {:name "ty", :expr "height/2"} {:name "zoom_precise", :value :gen-viz-960/long_diff.0, :bind {:input "range", :min 2, :max 30, :step 0.05}} {:name "centerY", :value :gen-viz-960/a_lat.0, :bind {:input "range", :min :gen-viz-960/min_lat.0, :max :gen-viz-960/max_lat.0, :full-min -60, :full-max 60, :step 1.0E-6}} {:name "centerX", :value :gen-viz-960/a_long.0, :bind {:input "range", :min :gen-viz-960/min_long.0, :max :gen-viz-960/max_long.0, :full-min -180, :full-max 180, :step 1.0E-6}} {:name "baseTileSize", :value 256} {:name "tileUrl", :value "https://a.tile.openstreetmap.org/"} {:name "zoom", :expr "ceil(zoom_precise)"} {:name "tilesCount", :expr "pow(2,zoom)"} {:name "tileSize", :expr "baseTileSize*pow(2,zoom_precise-zoom)"} {:name "maxTiles", :expr "ceil(max(height,width)/tileSize +1)"} {:name "basePoint", :expr "invert('projection',[0,0])"} {:name "dii", :expr "((basePoint[0]+180)/360*tilesCount)"} {:name "di", :expr "floor(dii)"} {:name "dx", :expr "round((floor(dii)-dii)*tileSize)"} {:name "djj", :expr "((1-log(tan(basePoint[1]*PI/180) + 1/cos(basePoint[1]*PI/180))/PI)/2 *tilesCount)"} {:name "dj", :expr "floor(djj)"} {:name "dy", :expr "round((floor(djj)-djj)*tileSize)"} {:name "scale", :expr "baseTileSize * pow(2,zoom_precise) / (2 * PI)"}], :layer [[:if :condi/geo-background? {:data {:name "tile_list", :sequence {:start 0, :stop {:signal "maxTiles"}, :as "a"}}, :transform [{:calculate "sequence(0,maxTiles)", :as "b"} {:flatten ["b"]} {:calculate "tileUrl+zoom+'/'+(datum.a+di+tilesCount)%tilesCount+'/'+((datum.b+dj))+'.png'", :as "url"} {:calculate "(datum.a * tileSize + dx)+(tileSize/2)", :as "x"} {:calculate "(datum.b * tileSize + dy)+(tileSize/2)", :as "y"}], :mark {:type "image", :opacity 0.5, :background "#000000", :fill "#000000", :width {:signal "tileSize"}, :height {:signal "tileSize"}}, :encoding {:x {:field "x", :type "quantitative", :scale nil}, :y {:field "y", :type "quantitative", :scale nil}, :url {:field "url", :type "nominal"}}} {:mark "geoshape", :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}}] {:data {:values :gen-viz-1104}, :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}, :mark {:type "point"}, :encoding {:latitude {:field :Lat, :type "quantitative"}, :size {:field nil, :type "quantitative"}, :color {:field 1, :scale {:scheme "darkmulti"}, :type "nominal"}, :longitude {:field :Long, :type "quantitative"}}, :background "transparent"} [:if :condi/us-counties? {:data {:name "us-counties", :url "https://raw.githubusercontent.com/vega/vega/61dd8b1fdb9a268dc80c986938a5983d27cf8f2c/docs/data/us-10m.json", :format {:type "topojson", :feature "counties"}}, :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}, :mark "geoshape", :encoding {:fill {:value "#a500ff22"}, :fillOpacity {:value 0.1}, :stroke {:value "#FFA50022"}, :strokeWidth {:value 2}}, :background "transparent"} {:mark "geoshape", :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}}] [:if :condi/us-states? {:data {:name "us-states", :url "https://raw.githubusercontent.com/vega/vega/61dd8b1fdb9a268dc80c986938a5983d27cf8f2c/docs/data/us-10m.json", :format {:type "topojson", :feature "states"}}, :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}, :mark "geoshape", :encoding {:fill {:value "#FFA50044"}, :fillOpacity {:value 0.1}, :stroke {:value "#FFA50044"}, :strokeWidth {:value 2}}, :background "transparent"} {:mark "geoshape", :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}}] [:if :condi/country-lines? {:data {:name "world", :url "https://vega.github.io/vega-datasets/data/world-110m.json", :format {:type "topojson", :feature "countries"}}, :mark "geoshape", :encoding {:fill {:value "#FFA500"}, :fillOpacity {:value 0.1}, :stroke {:value "#FFA500"}, :strokeWidth {:value 2}}, :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}} {:mark "geoshape", :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}}]], :background "transparent", :config {:view {:stroke "transparent"}}} {:actions false}]]}}, :block-6004 {:h 7, :w 22, :connection-id "-1028099156", :name "select-all-ref_us_counties", :queries {:ref-us-counties-drag-155 {:select [:fips_county_code :fips_state_code :housing_units :land_area :latitude :longitude :name :population :state_abbrev :water_area], :from [[:ref_us_counties :hh216]]}}, :root [1 7]}, :block-5154 {:h 7, :w 5, :root [23 7], :name "block-5154", :views {:hi [:box :align :center :justify :center :style {:font-size "106px", :font-weight 700, :padding-top "6px", :padding-left "14px", :margin-top "-8px", :color "#f9b9f9", :font-family "Poppins"} :child "hi!"]}, :queries {:query-10391 {:select [[[:count 1] :rowcnt] :fips_state_code], :from [[:query/ref-us-counties-drag-155 :mm64]], :group-by [:fips_state_code]}}, :connection-id "-1028099156", :selected-view :query-10391}, :block-7245 {:h 13, :w 19, :views {:view-clone [:box :child [:vega-lite {:width "container", :height :panel-height+50, :autosize "none", :padding {:top 0, :bottom 0, :left 0, :right 0}, :params [{:name "tx", :expr "width/2"} {:name "ty", :expr "height/2"} {:name "zoom_precise", :value 5, :bind {:input "range", :min 2, :max 30, :step 0.05}} {:name "centerY", :value :gen-viz-960/a_lat.0, :bind {:input "range", :min :gen-viz-960/min_lat.0, :max :gen-viz-960/max_lat.0, :full-min -60, :full-max 60, :step 1.0E-6}} {:name "centerX", :value :gen-viz-960/a_long.0, :bind {:input "range", :min :gen-viz-960/min_long.0, :max :gen-viz-960/max_long.0, :full-min -180, :full-max 180, :step 1.0E-6}} {:name "baseTileSize", :value 256} {:name "tileUrl", :value "https://a.tile.openstreetmap.org/"} {:name "zoom", :expr "ceil(zoom_precise)"} {:name "tilesCount", :expr "pow(2,zoom)"} {:name "tileSize", :expr "baseTileSize*pow(2,zoom_precise-zoom)"} {:name "maxTiles", :expr "ceil(max(height,width)/tileSize +1)"} {:name "basePoint", :expr "invert('projection',[0,0])"} {:name "dii", :expr "((basePoint[0]+180)/360*tilesCount)"} {:name "di", :expr "floor(dii)"} {:name "dx", :expr "round((floor(dii)-dii)*tileSize)"} {:name "djj", :expr "((1-log(tan(basePoint[1]*PI/180) + 1/cos(basePoint[1]*PI/180))/PI)/2 *tilesCount)"} {:name "dj", :expr "floor(djj)"} {:name "dy", :expr "round((floor(djj)-djj)*tileSize)"} {:name "scale", :expr "baseTileSize * pow(2,zoom_precise) / (2 * PI)"}], :layer [[:if :condi/geo-background? {:data {:name "tile_list", :sequence {:start 0, :stop {:signal "maxTiles"}, :as "a"}}, :transform [{:calculate "sequence(0,maxTiles)", :as "b"} {:flatten ["b"]} {:calculate "tileUrl+zoom+'/'+(datum.a+di+tilesCount)%tilesCount+'/'+((datum.b+dj))+'.png'", :as "url"} {:calculate "(datum.a * tileSize + dx)+(tileSize/2)", :as "x"} {:calculate "(datum.b * tileSize + dy)+(tileSize/2)", :as "y"}], :mark {:type "image", :opacity 0.5, :background "#000000", :fill "#000000", :width {:signal "tileSize"}, :height {:signal "tileSize"}}, :encoding {:x {:field "x", :type "quantitative", :scale nil}, :y {:field "y", :type "quantitative", :scale nil}, :url {:field "url", :type "nominal"}}} {:mark "geoshape", :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}}] {:data {:values :gen-viz-1104}, :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}, :mark {:type "point"}, :encoding {:latitude {:field :Lat, :type "quantitative"}, :size {:field nil, :type "quantitative"}, :color {:field 1, :scale {:scheme "darkmulti"}, :type "nominal"}, :longitude {:field :Long, :type "quantitative"}}, :background "transparent"} [:if :condi/us-counties? {:data {:name "us-counties", :url "https://raw.githubusercontent.com/vega/vega/61dd8b1fdb9a268dc80c986938a5983d27cf8f2c/docs/data/us-10m.json", :format {:type "topojson", :feature "counties"}}, :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}, :mark "geoshape", :encoding {:fill {:value "#a500ff22"}, :fillOpacity {:value 0.1}, :stroke {:value "#FFA50022"}, :strokeWidth {:value 2}}, :background "transparent"} {:mark "geoshape", :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}}] [:if :condi/us-states? {:data {:name "us-states", :url "https://raw.githubusercontent.com/vega/vega/61dd8b1fdb9a268dc80c986938a5983d27cf8f2c/docs/data/us-10m.json", :format {:type "topojson", :feature "states"}}, :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}, :mark "geoshape", :transform [{:lookup :id, :from {:data {:values :query-10391}, :key :fips_state_code, :fields [:fips_state_code :rowcnt]}}], :encoding {:color {:field :rowcnt, :scale2 {:scheme "reds"}, :scale {:scheme "darkmulti"}}, :stroke {:value "#FFA50077"}, :strokeWidth {:value 2}}, :background "transparent"} {:mark "geoshape", :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}}] [:if :condi/country-lines? {:data {:name "world", :url "https://vega.github.io/vega-datasets/data/world-110m.json", :format {:type "topojson", :feature "countries"}}, :mark "geoshape", :encoding {:fill {:value "#FFA500"}, :fillOpacity {:value 0.1}, :stroke {:value "#FFA500"}, :strokeWidth {:value 2}}, :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}} {:mark "geoshape", :projection {:type "mercator", :scale {:expr "scale"}, :center [{:signal "centerX"} {:signal "centerY"}], :translate [{:signal "tx"} {:signal "ty"}]}}]], :background "transparent", :config {:view {:stroke "transparent"}}} {:actions false}]]}, :name "clone-oz533", :root [37 7]}}, :selected-block :block-7245, :query-history-condi {:country-lines? 1679736966, :us-counties? 1679736966, :us-states? 1679736966, :geo-background? 1679736966}, :click-param {:conn-list {:connection_id "-1245280001", :database_name "Microsoft SQL Server", :database_version "15.00.4261"}, :connections-sys {:database_name "*csv-import-db*", :connection_id "-1028099156"}, :tables-sys {:db_schema "none", :db_catalog nil, :connection_id "-1028099156", :schema_cat nil, :table_name "ref_us_counties", :fields 11}, :viz-tables-sys {:table_name "offenses_drag_749", :recos 407}, :viz-shapes0-sys {:shape "point_map", :recos 1}, :recos-sys {:query_map "[{:select-distinct [:Lat :Long], :from [\"query/offenses_drag_749\"]} {:select [[[:min :Long] :min-long] [[:max :Long] :max-long] [[:min :Lat] :min-lat] [[:max :Lat] :max-lat] [[:avg :Lat] :a-lat] [[:avg :Long] :a-long] [[:round [:raw [\"(\" [:max :Long] \" - \" [:min :Long] \") * 55\"]] 2] :long_diff] [[:round [:raw [\"(\" [:max :Lat] \" - \" [:min :Lat] \") * 55\"]] 2] :lat_diff]], :from [\"query/offenses_drag_749\"], :where [:and [:<> :Lat -1] [:<> :Lat nil] [:<> :Long -1] [:<> :Long nil]]}]", :shape_name "point_map", :w nil, :combo_edn "\"Lat, Long\"", :query_map_str "SELECT DISTINCT Lat, Long FROM 'query/offenses_drag_749'", :combo_hash "-400719963", :h nil, :condis "{:country-lines? true, :us-counties? false, :us-states? false, :geo-background? true}", :table_name "offenses_drag_749", :connection_id "1611117821", :context_hash "525542104", :viz_map "[:box :child [:vega-lite {:width \"container\", :height :panel-height+50, :autosize \"none\", :padding {:top 0, :bottom 0, :left 0, :right 0}, :params [{:name \"tx\", :expr \"width/2\"} {:name \"ty\", :expr \"height/2\"} {:name \"zoom_precise\", :value :query-preview-2/long_diff.0, :bind {:input \"range\", :min 2, :max 30, :step 0.05}} {:name \"centerY\", :value :query-preview-2/a_lat.0, :bind {:input \"range\", :min :query-preview-2/min_lat.0, :max :query-preview-2/max_lat.0, :full-min -60, :full-max 60, :step 1.0E-6}} {:name \"centerX\", :value :query-preview-2/a_long.0, :bind {:input \"range\", :min :query-preview-2/min_long.0, :max :query-preview-2/max_long.0, :full-min -180, :full-max 180, :step 1.0E-6}} {:name \"baseTileSize\", :value 256} {:name \"tileUrl\", :value \"https://a.tile.openstreetmap.org/\"} {:name \"zoom\", :expr \"ceil(zoom_precise)\"} {:name \"tilesCount\", :expr \"pow(2,zoom)\"} {:name \"tileSize\", :expr \"baseTileSize*pow(2,zoom_precise-zoom)\"} {:name \"maxTiles\", :expr \"ceil(max(height,width)/tileSize +1)\"} {:name \"basePoint\", :expr \"invert('projection',[0,0])\"} {:name \"dii\", :expr \"((basePoint[0]+180)/360*tilesCount)\"} {:name \"di\", :expr \"floor(dii)\"} {:name \"dx\", :expr \"round((floor(dii)-dii)*tileSize)\"} {:name \"djj\", :expr \"((1-log(tan(basePoint[1]*PI/180) + 1/cos(basePoint[1]*PI/180))/PI)/2 *tilesCount)\"} {:name \"dj\", :expr \"floor(djj)\"} {:name \"dy\", :expr \"round((floor(djj)-djj)*tileSize)\"} {:name \"scale\", :expr \"baseTileSize * pow(2,zoom_precise) / (2 * PI)\"}], :layer [[:if :condi/geo-background? {:data {:name \"tile_list\", :sequence {:start 0, :stop {:signal \"maxTiles\"}, :as \"a\"}}, :transform [{:calculate \"sequence(0,maxTiles)\", :as \"b\"} {:flatten [\"b\"]} {:calculate \"tileUrl+zoom+'/'+(datum.a+di+tilesCount)%tilesCount+'/'+((datum.b+dj))+'.png'\", :as \"url\"} {:calculate \"(datum.a * tileSize + dx)+(tileSize/2)\", :as \"x\"} {:calculate \"(datum.b * tileSize + dy)+(tileSize/2)\", :as \"y\"}], :mark {:type \"image\", :opacity 0.5, :background \"#000000\", :fill \"#000000\", :width {:signal \"tileSize\"}, :height {:signal \"tileSize\"}}, :encoding {:x {:field \"x\", :type \"quantitative\", :scale nil}, :y {:field \"y\", :type \"quantitative\", :scale nil}, :url {:field \"url\", :type \"nominal\"}}} {:mark \"geoshape\", :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}}] {:data {:values :query-preview}, :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}, :mark {:type \"point\"}, :encoding {:latitude {:field :Lat, :type \"quantitative\"}, :size {:field nil, :type \"quantitative\"}, :color {:field 1, :scale {:scheme \"darkmulti\"}, :type \"nominal\"}, :longitude {:field :Long, :type \"quantitative\"}}, :background \"transparent\"} [:if :condi/us-counties? {:data {:name \"us-counties\", :url \"https://raw.githubusercontent.com/vega/vega/61dd8b1fdb9a268dc80c986938a5983d27cf8f2c/docs/data/us-10m.json\", :format {:type \"topojson\", :feature \"counties\"}}, :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}, :mark \"geoshape\", :encoding {:fill {:value \"#a500ff22\"}, :fillOpacity {:value 0.1}, :stroke {:value \"#FFA50022\"}, :strokeWidth {:value 2}}, :background \"transparent\"} {:mark \"geoshape\", :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}}] [:if :condi/us-states? {:data {:name \"us-states\", :url \"https://raw.githubusercontent.com/vega/vega/61dd8b1fdb9a268dc80c986938a5983d27cf8f2c/docs/data/us-10m.json\", :format {:type \"topojson\", :feature \"states\"}}, :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}, :mark \"geoshape\", :encoding {:fill {:value \"#FFA50044\"}, :fillOpacity {:value 0.1}, :stroke {:value \"#FFA50044\"}, :strokeWidth {:value 2}}, :background \"transparent\"} {:mark \"geoshape\", :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}}] [:if :condi/country-lines? {:data {:name \"world\", :url \"https://vega.github.io/vega-datasets/data/world-110m.json\", :format {:type \"topojson\", :feature \"countries\"}}, :mark \"geoshape\", :encoding {:fill {:value \"#FFA500\"}, :fillOpacity {:value 0.1}, :stroke {:value \"#FFA500\"}, :strokeWidth {:value 2}}, :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}} {:mark \"geoshape\", :projection {:type \"mercator\", :scale {:expr \"scale\"}, :center [{:signal \"centerX\"} {:signal \"centerY\"}], :translate [{:signal \"tx\"} {:signal \"ty\"}]}}]], :background \"transparent\", :config {:view {:stroke \"transparent\"}}} {:actions false}]]"}}, :post-condi {:country-lines? [{:v 1}], :us-states? [{:v 1}], :us-counties? [{:v 1}], :geo-background? [{:v 1}]}}